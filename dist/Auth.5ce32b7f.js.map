{"version":3,"sources":["containers/Auth/Auth.js"],"names":["Auth","Component","console","log","appTitle","window","wallet","requestSignIn","nearConfig","contractName","location","search","includes","replace","origin","pathname","componentDidMount","props","building","authRedirectPath","setPath","isSignedIn","setCurrentUser","currentUser","render","isAuthenticated","mapStateToProps","state","auth","iceCreamBuilder","mapDispatchToProps","dispatch","actions","LogIn","setRedirectPath"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAEA;;AAEA;;;;;;;;;;AACA,MAAMA,IAAN,SAAmBC,gBAAnB,CAA6B;AAAA;AAAA;;AAAA,2CAUX,YAAY;AAC1BC,MAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,YAAMC,QAAQ,GAAG,eAAjB;AACA,YAAMC,MAAM,CAACC,MAAP,CAAcC,aAAd,CAA4BF,MAAM,CAACG,UAAP,CAAkBC,YAA9C,EAA4DL,QAA5D,CAAN;;AACA,UAAIC,MAAM,CAACK,QAAP,CAAgBC,MAAhB,CAAuBC,QAAvB,CAAgC,YAAhC,CAAJ,EAAmD;AACjDP,QAAAA,MAAM,CAACK,QAAP,CAAgBG,OAAhB,CACER,MAAM,CAACK,QAAP,CAAgBI,MAAhB,GAAyBT,MAAM,CAACK,QAAP,CAAgBK,QAD3C;AAGD;AACF,KAnB0B;AAAA;;AAC3BC,EAAAA,iBAAiB,GAAG;AAClB,QAAI,CAAC,KAAKC,KAAL,CAAWC,QAAZ,IAAwB,KAAKD,KAAL,CAAWE,gBAAX,KAAgC,GAA5D,EAAiE;AAC/D,WAAKF,KAAL,CAAWG,OAAX;AACD;;AACD,QAAIf,MAAM,CAACC,MAAP,CAAce,UAAd,EAAJ,EAAgC;AAC9B,WAAKJ,KAAL,CAAWK,cAAX,CAA0BjB,MAAM,CAACkB,WAAjC;AACD;AACF;;AAaDC,EAAAA,MAAM,GAAG;AACP,QAAI,KAAKP,KAAL,CAAWQ,eAAf,EAAgC;AAC9B,0BAAO,6BAAC,wBAAD;AAAU,QAAA,EAAE,EAAE,KAAKR,KAAL,CAAWE;AAAzB,QAAP;AACD;;AAED,wBACE,6BAAC,eAAD;AAAQ,MAAA,OAAO,EAAE,KAAKZ;AAAtB,+CAEE,4CAAS;;;;;;;;;;;;;;;MAAT,CAFF,CADF;AAqBD;;AA/C0B;;AAkD7B,MAAMmB,eAAe,GAAIC,KAAD,IAAW;AACjC,SAAO;AACLF,IAAAA,eAAe,EAAE,CAAC,CAACE,KAAK,CAACC,IAAN,CAAWL,WADzB;AAELL,IAAAA,QAAQ,EAAES,KAAK,CAACE,eAAN,CAAsBX,QAF3B;AAGLC,IAAAA,gBAAgB,EAAEQ,KAAK,CAACC,IAAN,CAAWT;AAHxB,GAAP;AAKD,CAND;;AAQA,MAAMW,kBAAkB,GAAIC,QAAD,IAAc;AACvC,SAAO;AACLT,IAAAA,cAAc,EAAGC,WAAD,IAAiBQ,QAAQ,CAACC,OAAO,CAACC,KAAR,CAAcV,WAAd,CAAD,CADpC;AAELH,IAAAA,OAAO,EAAE,MAAMW,QAAQ,CAACC,OAAO,CAACE,eAAR,CAAwB,GAAxB,CAAD;AAFlB,GAAP;AAID,CALD;;eAOe,yBAAQR,eAAR,EAAyBI,kBAAzB,EAA6C9B,IAA7C","file":"Auth.5ce32b7f.js","sourceRoot":"../src","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\n\nimport * as actions from \"../../store/actions/index\";\n\nimport Button from \"../../components/Utils/Button\";\nclass Auth extends Component {\n  componentDidMount() {\n    if (!this.props.building && this.props.authRedirectPath !== \"/\") {\n      this.props.setPath();\n    }\n    if (window.wallet.isSignedIn()) {\n      this.props.setCurrentUser(window.currentUser);\n    }\n  }\n\n  requestSignIn = async () => {\n    console.log(\"start sign in\");\n    const appTitle = \"NEAR ICECREAM\";\n    await window.wallet.requestSignIn(window.nearConfig.contractName, appTitle);\n    if (window.location.search.includes(\"account_id\")) {\n      window.location.replace(\n        window.location.origin + window.location.pathname\n      );\n    }\n  };\n\n  render() {\n    if (this.props.isAuthenticated) {\n      return <Redirect to={this.props.authRedirectPath} />;\n    }\n\n    return (\n      <Button clicked={this.requestSignIn}>\n        Log In with NEAR Wallet\n        <style>{`\n      .Auth {\n        margin: 20px auto;\n        width: 80%;\n        text-align: center;\n        box-shadow: 0 2px 3px #ccc;\n        border: 1px solid #eee;\n        padding: 10px;\n        box-sizing: border-box;\n    }\n    \n    @media (min-width: 600px) {\n        .Auth {\n            width: 500px;\n        }\n    }`}</style>\n      </Button>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    isAuthenticated: !!state.auth.currentUser,\n    building: state.iceCreamBuilder.building,\n    authRedirectPath: state.auth.authRedirectPath,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    setCurrentUser: (currentUser) => dispatch(actions.LogIn(currentUser)),\n    setPath: () => dispatch(actions.setRedirectPath(\"/\")),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Auth);\n"]}